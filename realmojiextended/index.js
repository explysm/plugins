(function(u,f,l){"use strict";const a=[],{getCustomEmojiById:b}=f.findByStoreName("EmojiStore"),d=f.findByName("RowManager"),s=/https:\/\/cdn.discordapp.com\/emojis\/(\d+)\.\w+/;a.push(l.before("generate",d.prototype,function([n]){if(n.rowType!==1)return;let e=n.message.content;if(!e?.length)return;const o=e.match(s)?.index;if(o===void 0)return;const c=e.slice(o).trim().split(`
`);if(!c.every(function(r){return r.match(s)}))return;for(e=e.slice(0,o);e.indexOf("  ")!==-1;)e=e.replace("  ",` ${c.shift()} `);e=e.trim(),c.length&&(e+=` ${c.join(" ")}`);const t=n.message.embeds;for(let r=0;r<t.length;r++){const i=t[r];i.type==="image"&&i.url.match(s)&&t.splice(r--,1)}n.message.content=e,n.__realmoji=!0})),a.push(l.after("generate",d.prototype,function([n],e){if(n.rowType!==1||n.__realmoji!==!0)return;const{content:o}=e.message;if(!Array.isArray(o))return;const c=o.every(function(t){return t.type==="link"&&t.target.match(s)||t.type==="text"&&t.content===" "});for(let t=0;t<o.length;t++){const r=o[t];if(r.type!=="link")continue;const i=r.target.match(s);if(!i)continue;const m=i[1],p=b(m),g=p?.animated??(i[0].includes(".gif")||i[0].includes(".webm")),y=g?i[0].includes(".webm")?"webm":"gif":"webp",h=`https://cdn.discordapp.com/emojis/${m}.${y}?size=128`;o[t]={type:"customEmoji",id:m,alt:p?.name??"<realmoji>",src:h,frozenSrc:h.replace(y,"webp"),animated:g,jumboable:c?!0:void 0}}}));const j=function(){return a.forEach(function(n){return n()})};return u.onUnload=j,u})({},vendetta.metro,vendetta.patcher);
